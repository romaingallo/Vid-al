{% extends 'html/base.html' %}
{% block title %}
    <title>Vidéal</title>
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="/css/style_watch.css">
    <link rel="stylesheet" href="/css/github_style.css">
    <link rel="icon" href="/images/favicon.ico" type="image/x-icon">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/video.js/7.20.3/video-js.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/video.js/7.20.3/video.min.js"></script>
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/videojs-contrib-hls/5.15.0/videojs-contrib-hls.min.js"></script> -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/dashjs/4.0.1/dash.all.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/videojs-contrib-dash/4.2.1/videojs-dash.min.js"></script>
{% endblock %}
{% block content %}
    <main id="contentwatch" class="contentwatch">

        <div class="videopanel">
            <video 
                id="video" 
                controls 
                autoplay="true" preload="auto"
                class="video-js vjs-big-play-centered"
                width="640"
                height="360"
            >
            </video>
            <div class="info">
                <div><a id="title" class="title">Titre de la vidéo exemple #xxx</a></div>
                <div>
                    <a href="/visit_channel/{{name}}"> <img class="pfpwatch" src="/pfp_of/{{name}}" alt="${{name}} pfp"></a>
                    <a id="sub" class="subtitle" href="/visit_channel/{{name}}">{{name}} • {{nb_views}} vues • xxx jours</a>
                    {% if connected %}
                        <div class="actions">
                            <button id="btn-like" class="btn {{green_state}}" aria-pressed="false">
                                Like <span id="like-count">{{nb_likes}}</span>
                            </button>
                            <button id="btn-dislike" class="btn {{red_state}}" aria-pressed="false">
                                Dislike <span id="dislike-count">{{nb_dislikes}}</span>
                            </button>
                            {% if is_following %}
                            <button class="githubbutton" onclick="toggle_is_following('{{name}}', this)">Unfollow</button>
                            {% else %}
                            <button class="githubbutton" onclick="toggle_is_following('{{name}}', this)">Follow</button>
                            {% endif %}
                        </div>
                    {% endif %}
                </div>
            </div>
            <div id="description">Description</div>
            {% if connected %}
            <form action="#" method="post" class="form">
                <label for="cmmnt" class="commenttext">Write a comment :</label><br>
                <input type="text" id="cmmnt" name="cmmnt" class="boxinput"><br>
                <input type="submit" value="Send" class="submitcommentbutton">
            </form>
            {% else %}
            <div>You need to be logged in to write a comment, to like, dislike, or to follow the channel.</div>
            {% endif %}
            <div id="comments">
                {%for i in range(0, lencomments)%}

                    <div data-id="{{comments[i][3]}}">
                        <div class="authorpfp"><a href="/visit_channel/{{comments[i][0]}}"> <img class="pfpwatch" src="/pfp_of/{{comments[i][0]}}" alt="${{comments[i][0]}} pfp"></a></div>
                        <div class="comment-text">
                            <div class="commentauthor">
                                {{comments[i][0]}}
                                <span class="commentdate">{{comments[i][2]}}</span>
                            </div>
                            <div class="commentcontent">{{comments[i][1]}}</div>
                        </div>
                        {% if comments[i][0] == username %}
                        <button class="deletecommentbutton" data-comment-id="{{comments[i][3]}}">Delete comment</button>
                        {% endif %}
                    </div>
                {%endfor%}
                
            </div>
        </div>

        <div id="gridcontent" class="gridcontent">
            
        </div>
        

    </main>
    <script type="text/javascript">
            const videoId = '{{videoId}}';
            const hostURLSource = '{{hostURL}}';
         </script>
    <script src="/js/video_source.js"></script>
    <script src="/js/script.js"></script>
    <script src="/js/watch_reaction.js"></script>
    <script src="/js/deletecommentbutton.js"></script>
    <script src="/js/following.js"></script>
{% endblock %}
